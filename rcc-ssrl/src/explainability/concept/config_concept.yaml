experiment:
  name: "xai_concept_ssl_rcc_vit"
  seed: 1337
  outputs_root: null   # overridden per ablation

evaluation_inputs:
  eval_run_dir: null   # overridden per ablation
  predictions_csv: "predictions.csv"
  logits_npy: "logits_test.npy"

data:
  backend: "webdataset"
  img_size: 224
  imagenet_norm: false
  num_workers: 4
  batch_size: 1
  webdataset:
    # NUOVO
    train_dir: "/beegfs-scratch/mla_group_01/workspace/mla_group_01/wsi-ssrl-rcc_project/data/processed/rcc_webdataset_final/train"
    # esistente
    test_dir: "/beegfs-scratch/mla_group_01/workspace/mla_group_01/wsi-ssrl-rcc_project/data/processed/rcc_webdataset_final/test"
    pattern: "shard-*.tar"
    image_key: "img.jpg;jpg;jpeg;png"
    meta_key: "meta.json;json"

labels:
  class_order: ["ccRCC", "pRCC", "CHROMO", "ONCO", "NOT_TUMOR"]

model:
  name: null                 # overridden per ablation
  arch_hint: "ssl_linear"
  backbone_name: "vit_small_patch16_224"
  ssl_backbone_ckpt: null    # overridden per ablation
  ssl_head_ckpt: null        # overridden per ablation

selection:
  per_class:
    topk_tp: 5
    topk_fp: 3
    topk_fn: 3
    lowconf_topk: 3
  min_per_class: 10

concepts:
  # concepts_rcc_v1.csv viene generato da build_concept_bank.py
  # concepts_rcc_v1.csv viene generato da build_concept_bank.py
  meta_csv: "/home/mla_group_01/rcc-ssrl/src/explainability/concept/ontology/concepts_rcc_v2.csv"
  concept_name_col: "concept_name"
  key_col: "wds_key"
  group_col: "group"
  class_col: "class_label"

  similarity: "cosine"
  topk_per_patch: 5
  min_patches_per_concept: 5

  similarity: "cosine"
  topk_per_patch: 5
  min_patches_per_concept: 5

runtime:
  device: "cuda"
  precision: "fp32"
